<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>SYCOMORE</title>

		<link rel="stylesheet" href="reveal/dist/reset.css">
		<link rel="stylesheet" href="reveal/dist/reveal.css">
		<link rel="stylesheet" href="reveal/dist/theme/dark.css">
		<link rel="stylesheet" href="reveal/plugin/highlight/monokai.css">

	</head>


	<body>


		<div class="reveal">
			<div class="slides">

				<section> 
					<h1 style="font-size: 2.5em;"> Using intrinsic dynamics to generate and control agile motions in legged robots </h1>
					</br>
					</br>
					<h3 style="text-align: center; color:#94e2d5"> Gabin Lembrez </h3>
				</section>


				<section class="data-auto-animate">
					<div class='multiCol'>
						<div class='col'>
							<img class="r-stretch fragment" data-fragment-index="1" width="100%" src="media/img/sports_dynamics.svg" /> 
						</div>
						<div class='col' style="text-align: left;">
						<!-- <h2 class="data-auto-animate"> Motivations </h2>   -->
					<h2 data-fragment-index="1" class="fragment"> Motivations </h2>
						</br>
							<p class="fragment">Biped locomotion from the perspective of living organisms:</p>
							<ul>
								</br>
								<li class="fragment"> Fluid and agile motions  </li>
								<li class="fragment"> Use of couplings (<em>Yeadon, 2000</em>)  </li>
								<li class="fragment"> Leveraging all the dynamic effects </li>
								</br>
							</ul> 
							<div class="alert fragment" style="text-align: center;">
							How well does it transfer to robotics?
							</div>
						</div>
					</div> 

					<aside class="notes">
						<p>On s'intéresse à la locomotion, en particulier bipède.
						Pour des êtres vivants, il n'est pas difficile de réaliser des mouvements fluides et agiles. 
						</p>
					</aside>

				</section>

				<section>
					<div class='multiCol'>
						<div class='col'>
							<div class="r-stack">
							<img class="fragment current-visible" data-fragment-index="1" width="60%" src="media/img/simpleMethods.svg" /> 
							<img class="fragment current-visible" data-fragment-index="2" width="90%" src="media/img/wholeBody.svg" /> 
							<img class="fragment current-visible" data-fragment-index="3" width="100%" src="media/img/virtualConstraints.svg" /> 
							<img class="fragment current-visible" data-fragment-index="4" width="100%" src="media/img/IA.svg" /> 
							</div>
						</div>
						<div class='col' style="text-align: left;">
							<h2 class="fragment" data-fragment-index="1"> State of the art </h2>
							<ul>
								</br>
								<li class="fragment" data-fragment-index="1"> Simple models: template control, ZMP control (<em>Chen 2023</em>) </li>
								<li class="fragment" data-fragment-index="2"> Online trajectory optimization and MPC (<em>Tassa et al. 2012 </em>) </li>
								<li class="fragment" data-fragment-index="3"> Limit cycle optimization with virtual constraints (<em> Westervelt et al. 2003</em>)</li>
								<li class="fragment" data-fragment-index="4"> Reinforcement learning (PPO - TRPO) (<em>Radosavovic et al., 2024 </em>) </li>
							</ul> 
						</div>
					</div> 
					<aside class="notes">
						Pour comprendre ces difficultés, résumé sommaire des méthodes existantes pour commander la locomotion bipède
						<ul>
							<li> robuste mais absorbe la dynamique </li>
							<li> corps complet. Puissant mais coûteux </li>
							<li> corps complet mais périodique </li>
							<li> complet + émergence mais base de données</li>
						</ul>
					</aside>
				</section>



				

				<section class="data-auto-animate">
					<div class="multiCol">
						<div class="col">
							<div class="r-stack">
							<img class="current-visible" data-fragment-index="0" width="50%" src="media/img/humanoid.svg" /> 
							</div>
						</div>
						<div class="col">
							<h2 style="margin-left: 0%; margin-bottom: 2em; font-size: 1.7em"> How to use the intrinsic dynamics to execute the next step ? </h2>
							<ul>
								<li> How to reduce the order of the model without losing rich dynamic effects ? </li>
								<li> How to operate the reduced order model safely ? </li>
							</ul>
						</div>
					</div>
					
				</section>

				<section class="data-auto-animate">
					<div class="r-stack">
					<img class="current-visible" width="75%" src="media/img/SYCOMORE_abstract-1.svg" />
					<img class="fragment current-visible" width="75%" src="media/img/SYCOMORE_abstract-2.svg" />
					<img class="fragment current-visible" width="75%" src="media/img/SYCOMORE_abstract-3.svg" />
					<img class="fragment current-visible" width="75%" src="media/img/SYCOMORE_abstract.svg" />
					</div>
				</section>


				<section> 
					<div class='multiCol'>
						<div class='col'>
							<img class="r-stretch" width="90%" src="media/img/viabilityDef.svg" /> 
						</div>
						<div class='col' style="text-align: left;font-size: 0.8em;">
							<h2> Viability kernel </h2>
							</br>
							<div class="block">
							<h4 style="color:#94e2d5"> Definition </h4>
							<p>The viability kernel $\mathcal{V}$ is the set of states from which there exists a strategy to avoid a set set of failure states  $\mathcal{F}$ (<em>Wieber, 2008</em>).</p>
							\[
							\begin{align}
								\mathcal{F} &= \left\{ x\in\mathcal{X} \; | \; \textit{The robot has fallen} \; \right\} \\
								\mathcal{V} &= \left\{ x(0)\in\mathcal{X} \; | \; \forall t>0, \exists u(t)\in\mathcal{U}: x(t)\notin \mathcal{F} \right\} 
							\end{align}
							\]
							</div>
							</br> 
						</div>
					</div> 
					<aside class="notes">
						Donner du sens à la capacité de ne pas tomber
					</aside>
				</section>

				<section>
					<div class="r-stack">
					<img class="current-visible" width="75%" src="media/img/SLIP_catppuccin-2.svg" />
					<img class="fragment current-visible" width="75%" src="media/img/SLIP_catppuccin-3.svg" />
					<img class="fragment current-visible" width="75%" src="media/img/SLIP_catppuccin-4.svg" />
					<img class="fragment current-visible" width="75%" src="media/img/SLIP_catppuccin-5.svg" />
					<img class="fragment current-visible" width="75%" src="media/img/SLIP_catppuccin.svg" />
					</div>
				</section>

				<section> 
					<!-- <h2> Viabilité du pendule sur ressort </h2> -->
					<div class='multiCol'>
						<div class='col'>
							<img class="r-stretch" width="100%" src="media/img/SLIPintegrable.svg" /> 
						</div>
						<div class='col'>
							<h3> Approximation of stance dynamics </h3>
							</br>
							<div style="text-align: left;">
							Under reasonable assumptions, stance dynamics is approximated by integrable spring-mass-damper dynamics (<em>Saranli et al., 2010</em>).
							\[
								\begin{align}
									r(t) &= Me^{-\xi\omega_0 t}\cos(\omega_d t + \phi) \\
									\theta(t) &= \alpha + \beta t + \gamma e^{-\xi\omega_0 t}\cos(\omega_d t + \psi)
								\end{align}
							\]
							The height of the next jump can be estimated.
							</div>
						</div>
					</div> 


					<aside class="notes">
						Pas intégrable donc approximation intégrable. Forme oscillateur + commenter figure et qualité 1%
					</aside>

				</section>
				
				<section data-auto-animate> 
					<!-- <h2> Commande basée sur la viabilité </h2> -->
					<div class='multiCol'>
						<div class='col'>
							<video class="r-stretch" width="100%" src="media/video/userInput.mp4" /> 
						</div>
						<div class='col' >
							<h3> Viability-based control </h3>
							<ul>
								</br>
								<li class="fragment"> Accomodates real-time user inputs </li>
								<li class="fragment"> Enables high speed hopping </li>
								<li class="fragment"> Quantitative robustness margin.   </li>
							</ul> 
						</div>
					</div> 

					<aside class="notes">
						on l'implémente
						<ol>
							<li>temps reel</li>
							<li>indep de vitesse</li>
							<li>marge de robustesse = distance bord du noyau</li>
							<li>Walking conference 2025</li>
						</ol>
					</aside>

				</section>

				

				

				

				<section>
					<div class="multiCol">
						<div class="col">
							<div class="r-stack">
							<img class="fragment current-visible" data-fragment-index="0" width="100%" src="media/img/HZD_prettier-1.svg" /> 
							<img class="fragment current-visible" data-fragment-index="1" width="100%" src="media/img/HZD_prettier-2.svg" /> 
							<img class="fragment current-visible" data-fragment-index="2" width="100%" src="media/img/HZD_prettier-3.svg" /> 
							<img class="fragment current-visible" data-fragment-index="3" width="100%" src="media/img/HZD_prettier-4.svg" /> 
							<img class="fragment current-visible" data-fragment-index="5" width="100%" src="media/img/HZD_prettier-5.svg" /> 
						    <video controls muted class="fragment current-visible" data-fragment-index="4" width="100%" src="media/video/three_links_walking.mp4" /> 
							</div>
						</div>
						<div class="col" style="text-align: left;">
						<h3> Extension with virtual constraints </h3>
						<div class="r-stack">
						<div class="block_flat fragment current-visible" data-fragment-index="0">
						<strong>Goal : </strong> Constrain the system to exist on a restricted space using partial feedback linearization (<em> Westervelt et al., 2003 - Griffin et al., 2017 </em>)
						</div>
						<div class="fragment current-visible" data-fragment-index="1"> 
							The <em>zero-dynamics</em> manifold associated with holonomic constraint $y(q)=0$
							\[
								\mathcal{Z} = \left\{ x\in T\mathcal{Q} \; | \; y(q) = 0,\; \dot y (q,\dot q) = 0 \right\}
							\]
							Feedback linearization controller:
							\[
								u = \left( L_gL_fy \right)^{-1} \left( v - L^2_f y \right)
							\]
						</div>
						<div class="fragment current-visible" data-fragment-index="2"> 
							Touch-down and lift-off occur when crossing the <em>impact surface</em>: $\mathcal{S}$. The hybrid zero-dynamics condition: 
							\[
								\mathcal{Z} \subset \mathcal{S} \cap \mathcal{Z}
							\]
						</div>
						<div class="fragment current-visible" data-fragment-index="3"> 
							Parametrize the constraints to find a periodic <em>limit-cycle</em> which minimizes 
							\[
								\frac{1}{d} \int_0^T u^2 dt =  \frac{energy}{distance}
							\]
							Subject to the hybrid condition and constraints on the actuators.
						</div>
						<div class="fragment current-visible" data-fragment-index="4"> 
							Parametrize the constraints to find a periodic <em>limit-cycle</em> which minimizes 
							\[
								\frac{1}{d} \int_0^T u^2 dt =  \frac{energy}{distance}
							\]
							Subject to the hybrid condition and constraints on the actuators.
						</div>
						<div class="fragment current-visible" data-fragment-index="5"> 
							<em> My Proposition:</em> 
							</br>
							</br> 
							<ol>
								<li> Find constraints with good dynamic behavior </li>
								<li> Control the actuated zero dynamics to maintain viability </li>
							</ol>
						</div>
						</div>

						</div>
					</div>
				</section>


				

				<section>
					<h2> References </h2>
					<div class="content" style="height: 800px; margin-left: 10%; margin-right: 5%; text-align: left;">
						<ul class="refList">
							</br>

							<li>Yeadon, Maurice R. "Aerial movement." <i>Biomechanics in sport: performance enhancement and injury prevention</i> (2000): 273-283.</li>

							<li> Chen, Yu-Ming. Toward High-Performance Simple Models of Legged Locomotion.<i> Diss. University of Pennsylvania,</i> 2023. </li>

							<li> Tassa, Yuval, Tom Erez, and Emanuel Todorov. "Synthesis and stabilization of complex behaviors through online trajectory optimization."<i> 2012 IEEE/RSJ International Conference on Intelligent Robots and Systems. </i> IEEE, 2012. </li>

							<li> Radosavovic, I., Xiao, T., Zhang, B., Darrell, T., Malik, J., & Sreenath, K. (2024). Real-world humanoid locomotion with reinforcement learning. <i> Science robotics, 9(89). </i> </li>

							<li> E. R. Westervelt, J. W. Grizzle and D. E. Koditschek, "Hybrid zero dynamics of planar biped walkers," in <i>IEEE Transactions on Automatic Control</i>, vol. 48, no. 1, pp. 42-56, Jan. 2003 </li>

							<li>Griffin B, Grizzle J. Nonholonomic virtual constraints and gait optimization for robust walking control. <i>The International Journal of Robotics Research.</i> 2017</li>

							<li>Saranli, U., Arslan, Ö., Ankarali, M.M. et al. Approximate analytic solutions to non-symmetric stance trajectories of the passive Spring-Loaded Inverted Pendulum with damping. <i>Nonlinear Dyn 62</i>, 729-742 (2010).</li>

							<li>S. Le Cleac'h et al., "Fast Contact-Implicit Model Predictive Control," in <i>IEEE Transactions on Robotics</i>, vol. 40, pp. 1617-1629, 2024</li>

							<li>Jallet, W., Bambade, A., Arlaud, E., El-Kazdadi, S., Mansard, N., & Carpentier, J. (2025). Proxddp: Proximal constrained trajectory optimization. <i>IEEE Transactions on Robotics</i>.</li>

							<li>Spong, M. W. (1999). Passivity based control of the compass gait biped. <i>IFAC Proceedings Volumes</i>, 32(2), 506-510.</li>

							<li>I. Poulakakis and J. W. Grizzle, "The Spring Loaded Inverted Pendulum as the Hybrid Zero Dynamics of an Asymmetric Hopper," in <i>IEEE Transactions on Automatic Control</i>, vol. 54, no. 8, pp. 1779-1793, Aug. 2009</li>

						</ul>
					</div>
				</section>

				<section>
					<h2> Inverted pendulum viability </h2>
					<p style="text-align: left; margin-left: 10%;"> The initial state $(\theta_0,\dot\theta_0)$ is viable if  <strong>no</strong> angle $\bar \theta \in [0;\pi/2]$ is solution of: </p>
					\[ mgl \sin\bar\theta = E_0 + \bar u (\bar\theta - \theta_0)  \]
					<img class="r-stretch" width="100%" src="media/img/pendulumGeom.svg" /> 
				</section>

				<section data-auto-animate> 
					<h2>Inverted pendulum viability </h2>
					<div class='multiCol'>
						<div class='col'>
							<img class="r-stretch" width="100%" src="media/img/viabilityPendulum.svg" /> 
						</div>
						<div class='col' style="text-align: left;">
							<div class="block">
							<h4 style="color:#94e2d5"> Theorem : </h4>
								$x=(\theta,\dot{\theta})\in \mathcal{V} $ if one of the following condition is met:
								<ol style="margin-left: 15%; font-size: 0.8em;">
									<li style="margin-top: 0.5em;margin-bottom: 0.5em;">
										$\dot{\theta}>0$ and $\bar{u}>1$
									</li> 
									<li  style="margin-top: 0.5em;margin-bottom: 0.5em;"> $\dot{\theta}<0$ and $\bar{u}\theta > \frac{l}{2g}\dot{\theta}^2+\sin\theta$ </li>
									<li style="margin-top: 0.5em;margin-bottom: 0.5em;"> $\dot{\theta}>0$, $\bar{u}<1$ and $\arccos(\bar{u})<\theta$ </li>
									<li style="margin-top: 0.5em;margin-bottom: 0.5em;"> $\dot{\theta}<0$, $\bar{u}<1$ and $\arccos(\bar{u})>\theta$  </li>
									<li style="margin-top: 0.5em;margin-bottom: 0.5em;"> $\bar{u}<1$, $sign(\dot{\theta})\arccos(\bar{u}) < sign(\dot{\theta})\theta$ aria-expanded="" 
									</li>
									\[
										\bar{u} > \frac{\sqrt{1-\bar{u}^2}-\frac{l}{2g}\dot{\theta}^2 - \sin\theta}{\arccos (\bar{u})- \theta}
									\]
									
								</ol>
						</div>
						</div>
					</div> 
				</section>

				<section>
					<video controls muted class="r-stretch" width="100%" src="media/video/abstract_LEMBREZ.mp4" /> 
				</section>




			</div>
		</div>

		<script src="reveal/dist/reveal.js"></script>
		<script src="reveal/plugin/notes/notes.js"></script>
		<script src="reveal/plugin/markdown/markdown.js"></script>
		<script src="reveal/plugin/highlight/highlight.js"></script>
		<script src="reveal/plugin/math/math.js"></script>
		<script>
			Reveal.initialize({
				transition: 'none',
				hash: true,
				slideNumber: true,
				width: 1920,
            	height: 1080,
  				autoPlayMedia: true,
				mathjax2: {
					config: 'TeX-AMS_HTML-full',
					TeX: {
						Macros: {
							R: '\\mathbb{R}',
							set: [ '\\left\\{#1 \\; ; \\; #2\\right\\}', 2 ]
						}
					}
				},
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.MathJax2  ]
			});
		</script>
	</body>
</html>